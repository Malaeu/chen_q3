/-
This file was generated by Aristotle.

Lean version: leanprover/lean4:v4.24.0
Mathlib version: f897ebcf72cd16f89ab4577d0c826cd14afaafc7
This project request had uuid: 29c888c8-3c99-458e-9302-66d7324ba18f
-/

/-
Formalized the Q3 Spectral Gap Axiom and its consequence, the operator norm bound.
Defined the necessary constants `t_min`, `V_K`, `Hamiltonian`, and `c_0` as opaque definitions.
Defined the statements `c_0_pos_statement` and `Q3_spectral_gap_statement` to represent the axioms.
Proved `H_lower_bound` (Theorem 8.35 consequence) assuming the spectral gap and that `V_K` is closed under scalar multiplication.
Note: The axioms `c_0_pos` and `Q3_spectral_gap` were not added as global axioms due to restrictions, but were instead formulated as statements and used as hypotheses where needed.
-/

import Mathlib

set_option linter.mathlibStandardSet false

open scoped BigOperators
open scoped Real
open scoped Nat
open scoped Classical
open scoped Pointwise

set_option maxHeartbeats 0
set_option maxRecDepth 4000
set_option synthInstance.maxHeartbeats 20000
set_option synthInstance.maxSize 128

set_option relaxedAutoImplicit false
set_option autoImplicit false

noncomputable section

opaque t_min (K : ℝ) : ℝ
opaque V_K {H : Type*} [NormedAddCommGroup H] [InnerProductSpace ℂ H] (t K : ℝ) (k : ℝ → H) : Set H
opaque Hamiltonian {H : Type*} [NormedAddCommGroup H] [InnerProductSpace ℂ H] [CompleteSpace H]
  (t K : ℝ) (k : ℝ → H) (T_A : H →L[ℂ] H) (hK : 0 < K) : H →L[ℂ] H

/-- The archimedean constant c_0(K) -/
opaque c_0 (K : ℝ) : ℝ

def c_0_pos_statement : Prop := ∀ (K : ℝ), 0 < K → 0 < c_0 K

/-- Statement of Q3 Spectral Gap Axiom -/
def Q3_spectral_gap_statement {H : Type*} [NormedAddCommGroup H] [InnerProductSpace ℂ H] [CompleteSpace H]
    (t K : ℝ) (k : ℝ → H) (T_A : H →L[ℂ] H) (hK : 0 < K) (ht : t ≥ t_min K) : Prop :=
  ∀ v ∈ V_K t K k, ‖v‖ = 1 →
    (inner ℂ v (Hamiltonian t K k T_A hK v)).re ≥ c_0 K / 2

theorem H_lower_bound {H : Type*} [NormedAddCommGroup H] [InnerProductSpace ℂ H] [CompleteSpace H]
    (t K : ℝ) (k : ℝ → H) (T_A : H →L[ℂ] H) (hK : 0 < K) (ht : t ≥ t_min K)
    (h_gap : Q3_spectral_gap_statement t K k T_A hK ht)
    (hV_scale : ∀ v ∈ V_K t K k, ∀ (c : ℂ), c • v ∈ V_K t K k) :
  ∀ v ∈ V_K t K k, (inner ℂ v (Hamiltonian t K k T_A hK v)).re ≥ (c_0 K / 2) * ‖v‖^2 := by
    intro v hv
    by_cases hv_zero : v = 0;
    · simp +decide [ hv_zero ];
    · have := h_gap ( ‖v‖⁻¹ • v ) ( hV_scale v hv _ ) ?_ <;> simp_all +decide [ norm_smul, inner_smul_left ];
      convert mul_le_mul_of_nonneg_right this ( sq_nonneg ‖v‖ ) using 1 ; ring_nf ; simp +decide [ hv_zero, sq, mul_assoc, mul_comm, mul_left_comm ]