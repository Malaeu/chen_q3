/-
This file was generated by Aristotle.

Lean version: leanprover/lean4:v4.24.0
Mathlib version: f897ebcf72cd16f89ab4577d0c826cd14afaafc7
This project request had uuid: ddacd2df-70b1-4034-9e99-c66ad15a360f

Sorry, Aristotle was unable to complete the task in time.

-/

import Mathlib

set_option linter.mathlibStandardSet false

open scoped BigOperators
open scoped Real
open scoped Nat
open scoped Classical
open scoped Pointwise

set_option maxHeartbeats 0
set_option maxRecDepth 4000
set_option synthInstance.maxHeartbeats 20000
set_option synthInstance.maxSize 128

set_option relaxedAutoImplicit false
set_option autoImplicit false

noncomputable section

/-
Definition of the commutator of two operators A and B as AB - BA.
-/
open Real Complex MeasureTheory Filter Topology ContinuousLinearMap

-- Define the commutator for operators
noncomputable def op_commutator {E : Type*} [NormedAddCommGroup E] [InnerProductSpace â„‚ E] [CompleteSpace E]
  (A B : E â†’L[â„‚] E) : E â†’L[â„‚] E :=
  A * B - B * A

/-
The integral of a function bounded by 1 over a subset of [0, 1] is at most 1.
-/
open Real MeasureTheory Set Filter

theorem integral_bound_of_bounded_function
  {E : Type*} [NormedAddCommGroup E] [NormedSpace â„‚ E]
  (g : â„ â†’ E) (S : Set â„)
  (h_bound : âˆ€ x âˆˆ S, â€–g xâ€–^2 â‰¤ 1)
  (h_subset : S âŠ† Icc 0 1)
  (h_meas : MeasurableSet S)
  (h_int : IntegrableOn (fun x => â€–g xâ€–^2) S) :
  âˆ« x in S, â€–g xâ€–^2 â‰¤ 1 := by
  refine' le_trans ( MeasureTheory.setIntegral_mono_on _ _ _ fun x hx => h_bound x hx ) _;
  Â· exact h_int;
  Â· simp +zetaDelta at *;
    exact lt_of_le_of_lt ( MeasureTheory.measure_mono h_subset ) ( by simp +decide );
  Â· exact h_meas;
  Â· norm_num;
    exact le_trans ( ENNReal.toReal_mono ( by norm_num ) ( MeasureTheory.measure_mono h_subset ) ) ( by norm_num )

/-
The squared norm of the inner product âŸ¨f, F_Î± (U_2 f)âŸ© is bounded by 1.
-/
open Real Complex MeasureTheory Filter Topology ContinuousLinearMap

variable {l2 : Type*} [NormedAddCommGroup l2] [InnerProductSpace â„‚ l2] [CompleteSpace l2]

theorem integrand_bound
  (F_op : â„ â†’ l2 â†’L[â„‚] l2)
  (U_op : â„ â†’ l2 â†’L[â„‚] l2)
  (f : l2)
  (h_F_bound : âˆ€ Î±, â€–F_op Î±â€– â‰¤ 1)
  (h_U_bound : âˆ€ h, â€–U_op hâ€– â‰¤ 1)
  (hf : â€–fâ€– = 1) :
  âˆ€ Î±, â€–inner (ğ•œ := â„‚) f (F_op Î± (U_op 2 f))â€–^2 â‰¤ 1 := by
  intro Î±;
  -- By Cauchy-Schwarz inequality, we have |âŸ¨f, F_Î± (U_2 f)âŸ©| â‰¤ â€–fâ€– * â€–F_Î± (U_2 f)â€–.
  have h_cauchy_schwarz : â€–(inner â„‚ f ((F_op Î±) ((U_op 2) f)))â€– â‰¤ â€–fâ€– * â€–(F_op Î±) ((U_op 2) f)â€– := by
    exact norm_inner_le_norm _ _;
  -- Since â€–fâ€– = 1, we have â€–(F_op Î±) ((U_op 2) f)â€– â‰¤ â€–F_op Î±â€– * â€–(U_op 2) fâ€–.
  have h_norm_bound : â€–(F_op Î±) ((U_op 2) f)â€– â‰¤ â€–F_op Î±â€– * â€–(U_op 2) fâ€– := by
    exact ContinuousLinearMap.le_opNorm _ _;
  exact pow_le_oneâ‚€ ( by positivity ) ( h_cauchy_schwarz.trans <| by simpa [ hf ] using h_norm_bound.trans <| mul_le_mul ( h_F_bound Î± ) ( ContinuousLinearMap.le_opNorm ( U_op 2 ) f |> le_trans <| mul_le_of_le_one_left ( norm_nonneg f ) <| h_U_bound 2 ) ( by positivity ) <| by positivity )

/-
If Î´ is between 0 and 1/4, then 1 â‰¤ 4 / Î´Â².
-/
open Real

lemma rhs_arithmetic_bound (Î´ : â„) (hÎ´ : 0 < Î´) (hÎ´1 : Î´ < 1/4) :
  1 â‰¤ Î´â»Â¹ ^ 2 * 4 := by
  nlinarith [ inv_pos.2 hÎ´, mul_inv_cancelâ‚€ hÎ´.ne' ]