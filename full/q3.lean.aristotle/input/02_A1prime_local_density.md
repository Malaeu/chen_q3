# A1': Local Cone Density on Frequency Compacts

## Overview
This file formalizes the density theorem A1' which shows that Fejér×heat approximants are dense in the cone of even nonnegative continuous functions on compacts. This is crucial for the compact-by-compact transfer strategy.

## Definitions

### Fejér Kernel
$$\Lambda_B(x) := (1 - |x|/B)_+ = \max(0, 1 - |x|/B)$$

### Heat Kernel
$$\rho_t(x) := \frac{1}{\sqrt{4\pi t}} e^{-x^2/(4t)}$$

with $\int_{\mathbb{R}} \rho_t = 1$ and $\rho_t \geq 0$.

### Fejér×Heat Atoms
For $B > 0$, $t > 0$, $\tau \in [-R, R]$, define the even nonnegative frequency window:
$$\Phi_{B,t,\tau}(\xi) := \Lambda_B(\xi - \tau) \rho_t(\xi - \tau) + \Lambda_B(\xi + \tau) \rho_t(\xi + \tau)$$

### The Cone $\mathcal{C}$
The closed convex cone generated by finite nonnegative combinations of $\{\Phi_{B,t,\tau}\}$ with $\tau \in [-R, R]$ and $B$ sufficiently large.

---

## Theorem A1'-Density

**Statement:**
For every compact $[-K, K]$, the cone $\{\text{Fejér} * \text{heat approximants}\}$ is dense in $C^+_{\mathrm{even}}([-K, K])$ in $\|\cdot\|_\infty$.

**Proof:**
Fejér kernels form a positive approximation identity on $\mathbb{T}$; heat flow preserves positivity and evenness, hence the uniform limit remains in the cone.

---

## Theorem A1' (Main Local Density)

**Statement:**
Let $K = [-R, R]$ with $R > 0$. Let $\mathcal{C}$ be the closed convex cone generated by finite nonnegative combinations of $\{\Phi_{B,t,\tau}\}$ with $\tau \in [-R, R]$ and $B$ sufficiently large (depending on $R$). Then $\mathcal{C}$ is dense in $C^+_{\mathrm{even}}([-R, R])$ in the uniform norm.

**Proof (4 Steps):**

**Step 1 (Mollification):** Fix $f \in C^+_{\mathrm{even}}([-R, R])$ and $\varepsilon > 0$. Extend $f$ by zero to $\widetilde{f} \in C_c(\mathbb{R})$. Since $\rho_t$ is a positive approximate identity, there exists $t \in (0, t_0]$ such that:
$$\sup_{|\xi| \leq R} |(\widetilde{f} * \rho_t)(\xi) - f(\xi)| < \varepsilon/3$$
Set $g := \widetilde{f} * \rho_t$. Then $g \geq 0$, $g \in C^\infty(\mathbb{R})$, and $g$ is even.

**Step 2 (Positive Riemann Sums):** Choose a uniform partition $-R = \tau_0 < \tau_1 < \cdots < \tau_N = R$ with mesh $\Delta$ small enough so that:
$$g_R(\xi) := \sum_{j=0}^{N-1} g(\tau_j^*) \rho_t(\xi - \tau_j^*) (\tau_{j+1} - \tau_j)$$
satisfies $\sup_{|\xi| \leq R} |g_R(\xi) - g(\xi)| < \varepsilon/3$. Because coefficients are nonnegative, $g_R$ is a finite nonnegative combination of translates of $\rho_t$.

**Step 3 (Fejér Truncation):** For any $|\xi|, |\tau| \leq R$: $|\Lambda_B(\xi - \tau) - 1| \leq 2R/B$. Choosing $B \geq 6R/\varepsilon$ ensures:
$$\sup_{|\xi| \leq R, |\tau| \leq R} |\Lambda_B(\xi - \tau) - 1| < \varepsilon/3$$
Define the symmetric Fejér×heat mixture:
$$h(\xi) := \sum_{j=0}^{N-1} g(\tau_j^*) (\tau_{j+1} - \tau_j) \left[\Lambda_B(\xi - \tau_j^*) \rho_t(\xi - \tau_j^*) + \Lambda_B(\xi + \tau_j^*) \rho_t(\xi + \tau_j^*)\right]$$

**Step 4 (Collect Errors):** Since $g$ is even, by triangle inequality:
$$\sup_{|\xi| \leq R} |h(\xi) - f(\xi)| < \varepsilon$$
By construction, $h$ is a finite nonnegative combination of $\Phi_{B,t,\tau_j^*}$, hence $h \in \text{cone}\{\Phi_{B,t,\tau}\}$.

---

## Lemma A1'-Fixed-t (Fixed Heat Scale Density)

**Statement:**
Fix $K > 0$ and $t_0 > 0$. Let $\mathcal{C}_K(t_0)$ be the uniform-closure on $[-K, K]$ of the conoid generated by Fejér×heat atoms $\{\Phi_{B,t_0,\tau} : B > 0, |\tau| + B \leq K\}$ and their even symmetrizations. Then:
$$\mathcal{C}_K(t_0) = C^+_{\mathrm{even}}([-K, K])$$

**Proof:**
Let $f \in C^+_{\mathrm{even}}([-K, K])$ and $\varepsilon > 0$. Choose uniform grid with mesh $\delta > 0$ and hats $H_j(\xi) := \Lambda_\delta(\xi - \tau_j)$. By positive piecewise-linear interpolation:
$$h(\xi) := \sum_j f(\tau_j) H_j(\xi)$$
satisfies $\|h - f\|_\infty < \varepsilon/3$ and $h \geq 0$.

Since $\rho_{t_0}(\xi)$ is positive and Lipschitz on $[-K, K]$, for $\delta$ small:
$$\sup_{|u| \leq \delta} |\rho_{t_0}(\xi + u) - \rho_{t_0}(\xi)| \leq L_{t_0} \delta$$

Set $g(\xi) := \sum_j c_j \Phi_{\delta, t_0, \tau_j}(\xi)$ with $c_j := f(\tau_j) / \rho_{t_0}(\tau_j)$. Choosing $\delta$ small gives $\|g - f\|_\infty < \varepsilon$.

---

## Expected Lean Output

```lean
-- Definitions
noncomputable def Fejer_kernel (B : ℝ) (x : ℝ) : ℝ :=
  max 0 (1 - |x| / B)

noncomputable def heat_kernel (t : ℝ) (x : ℝ) : ℝ :=
  1 / Real.sqrt (4 * Real.pi * t) * Real.exp (-x^2 / (4 * t))

noncomputable def Fejer_heat_atom (B t τ : ℝ) (ξ : ℝ) : ℝ :=
  Fejer_kernel B (ξ - τ) * heat_kernel t (ξ - τ) +
  Fejer_kernel B (ξ + τ) * heat_kernel t (ξ + τ)

-- Theorem A1' density
theorem A1prime_density (R : ℝ) (hR : R > 0) (f : ℝ → ℝ)
    (hf_cont : ContinuousOn f (Set.Icc (-R) R))
    (hf_even : ∀ x, f x = f (-x))
    (hf_nonneg : ∀ x ∈ Set.Icc (-R) R, 0 ≤ f x)
    (ε : ℝ) (hε : ε > 0) :
    ∃ (n : ℕ) (c : Fin n → ℝ) (B t : Fin n → ℝ) (τ : Fin n → ℝ),
      (∀ i, 0 ≤ c i) ∧
      (∀ i, |τ i| ≤ R) ∧
      ∀ ξ ∈ Set.Icc (-R) R,
        |f ξ - ∑ i, c i * Fejer_heat_atom (B i) (t i) (τ i) ξ| < ε

-- Lemma: Fixed-t cone density
theorem A1prime_fixed_t_density (K t₀ : ℝ) (hK : K > 0) (ht₀ : t₀ > 0) :
    ∀ f : ℝ → ℝ, ContinuousOn f (Set.Icc (-K) K) →
      (∀ x, f x = f (-x)) → (∀ x ∈ Set.Icc (-K) K, 0 ≤ f x) →
      ∀ ε > 0, ∃ (approx : ℝ → ℝ),
        approx ∈ cone_closure K t₀ ∧
        ∀ ξ ∈ Set.Icc (-K) K, |f ξ - approx ξ| < ε
```
