/-
This file was generated by Aristotle.

Lean version: leanprover/lean4:v4.24.0
Mathlib version: f897ebcf72cd16f89ab4577d0c826cd14afaafc7
This project request had uuid: 6e8bdd2f-2503-471e-a132-b81a36a31b1f
-/

/-
Formalization of the final assembly of the proof of the Riemann Hypothesis, conditional on the analytic hypotheses (T0, A1', A2, A3, RKHS, T5).

The file defines:
- The Weil cone `Weil_cone` and the functional `Q`.
- Structures representing the analytic hypotheses: `Guinand_Weil_normalization`, `Fejer_heat_dense`, `Q_Lipschitz_on_compacts`, `Toeplitz_bridge`, `prime_contraction`, and `compact_transfer`.
- The main positivity theorem `Main_positivity`, which establishes `Q Φ ≥ 0` for all `Φ` in the Weil cone, given the analytic hypotheses and a compact support condition.
- The definition of the Riemann Hypothesis `Riemann_Hypothesis`.
- The main theorem `Riemann_Hypothesis_proof`, which proves the Riemann Hypothesis assuming the analytic chain and Weil's criterion.
- An explicit statement `RH` of the Riemann Hypothesis, derived from `Riemann_Hypothesis_proof`.
-/

import Mathlib

set_option linter.mathlibStandardSet false

open scoped BigOperators
open scoped Real
-- open scoped Nat  -- commented: conflicts with φ notation
open scoped Classical
open scoped Pointwise

set_option maxHeartbeats 0
set_option maxRecDepth 4000
set_option synthInstance.maxHeartbeats 20000
set_option synthInstance.maxSize 128

set_option relaxedAutoImplicit false
set_option autoImplicit false

noncomputable section

#check riemannZeta
#check Function.support

/-
Opaque definitions for the Weil cone and the functional Q.
-/
opaque Weil_cone : Set (ℝ → ℂ)
opaque Q : (ℝ → ℂ) → ℝ

/-
Hypothesis T0: Guinand-Weil normalization. Placeholder structure.
-/
structure Guinand_Weil_normalization where
  mk ::

/-
Hypothesis A1': Fejér×heat cone is dense in W_K. Placeholder structure.
-/
structure Fejer_heat_dense where
  mk ::

/-
Hypothesis A2: Q is continuous on W_K. Placeholder structure.
-/
structure Q_Lipschitz_on_compacts where
  mk ::

/-
Hypothesis A3: Toeplitz bridge. Placeholder structure.
-/
structure Toeplitz_bridge where
  mk ::

/-
Hypothesis RKHS: Prime contraction. Placeholder structure.
-/
structure prime_contraction where
  mk ::

/-
Hypothesis T5: Compact transfer. Contains the key result that Q is non-negative on functions with support in [-K, K].
-/
structure compact_transfer where
  positivity_on_compact : ∀ K > 0, ∀ Φ ∈ Weil_cone, (Function.support Φ ⊆ Set.Icc (-K) K) → Q Φ ≥ 0

/-
Main Positivity Theorem: If the analytic chain holds, then Q is non-negative on the Weil cone. (Modified to take Weil_cone_compact_support as a hypothesis).
-/
theorem Main_positivity
    (T0 : Guinand_Weil_normalization)
    (A1' : Fejer_heat_dense)
    (A2 : Q_Lipschitz_on_compacts)
    (A3 : Toeplitz_bridge)
    (RKHS : prime_contraction)
    (T5 : compact_transfer)
    (Weil_cone_compact_support : ∀ Φ ∈ Weil_cone, ∃ K > 0, Function.support Φ ⊆ Set.Icc (-K) K) :
    ∀ Φ ∈ Weil_cone, Q Φ ≥ 0 := by
      exact fun Φ hΦ => T5.positivity_on_compact _ ( Weil_cone_compact_support Φ hΦ |> Classical.choose_spec |> And.left ) _ hΦ ( Weil_cone_compact_support Φ hΦ |> Classical.choose_spec |> And.right )

/-
Definition of the Riemann Hypothesis: All non-trivial zeros of the Riemann zeta function have real part 1/2.
-/
def Riemann_Hypothesis : Prop :=
  ∀ s : ℂ, riemannZeta s = 0 → 0 < s.re → s.re < 1 → s.re = 1/2

/-
Proof of the Riemann Hypothesis, conditional on the analytic chain, the compact support property, and Weil's criterion.
-/
theorem Riemann_Hypothesis_proof
    (T0 : Guinand_Weil_normalization)
    (A1' : Fejer_heat_dense)
    (A2 : Q_Lipschitz_on_compacts)
    (A3 : Toeplitz_bridge)
    (RKHS : prime_contraction)
    (T5 : compact_transfer)
    (Weil_cone_compact_support : ∀ Φ ∈ Weil_cone, ∃ K > 0, Function.support Φ ⊆ Set.Icc (-K) K)
    (Weil_criterion : (∀ Φ ∈ Weil_cone, Q Φ ≥ 0) ↔ Riemann_Hypothesis) :
    Riemann_Hypothesis := by
  -- First establish Q ≥ 0 on Weil cone
  have hQ := Main_positivity T0 A1' A2 A3 RKHS T5 Weil_cone_compact_support
  -- Apply Weil criterion
  exact Weil_criterion.mp hQ

/-
Explicit statement of the Riemann Hypothesis, conditional on the analytic chain. This theorem unfolds the definition of the Riemann Hypothesis and proves it using the previously established `Riemann_Hypothesis_proof`.
-/
abbrev Riemann_zeta := riemannZeta

theorem RH
    (T0 : Guinand_Weil_normalization)
    (A1' : Fejer_heat_dense)
    (A2 : Q_Lipschitz_on_compacts)
    (A3 : Toeplitz_bridge)
    (RKHS : prime_contraction)
    (T5 : compact_transfer)
    (Weil_cone_compact_support : ∀ Φ ∈ Weil_cone, ∃ K > 0, Function.support Φ ⊆ Set.Icc (-K) K)
    (Weil_criterion : (∀ Φ ∈ Weil_cone, Q Φ ≥ 0) ↔ Riemann_Hypothesis) :
    ∀ s : ℂ, Riemann_zeta s = 0 → 0 < s.re → s.re < 1 → s.re = 1/2 := by
  intro s hs hpos hless
  have h_RH := Riemann_Hypothesis_proof T0 A1' A2 A3 RKHS T5 Weil_cone_compact_support Weil_criterion
  exact h_RH s hs hpos hless