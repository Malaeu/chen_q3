/-
This file was generated by Aristotle.

Lean version: leanprover/lean4:v4.24.0
Mathlib version: f897ebcf72cd16f89ab4577d0c826cd14afaafc7
This project request had uuid: 61d36c84-592a-4696-a282-7d4adefb19bd

Sorry, Aristotle was unable to complete the task in time.

-/

import Mathlib

set_option linter.mathlibStandardSet false

open scoped BigOperators
open scoped Real
open scoped Nat
open scoped Classical
open scoped Pointwise

set_option maxHeartbeats 0
set_option maxRecDepth 4000
set_option synthInstance.maxHeartbeats 20000
set_option synthInstance.maxSize 128

set_option relaxedAutoImplicit false
set_option autoImplicit false

noncomputable section

/-
Define the projection onto the minor subspace.
-/
open Complex Real InnerProductSpace Submodule

variable {H : Type*} [NormedAddCommGroup H] [InnerProductSpace ℂ H] [CompleteSpace H]

/-- Projection onto minor subspace -/
noncomputable def P_minor (H_minor : Submodule ℂ H) [CompleteSpace H_minor] : H →L[ℂ] H :=
  H_minor.subtypeL.comp H_minor.orthogonalProjection

/-
Helper lemma: Inner product with projection is equal to inner product with original vector for elements in the subspace.
-/
section InnerProj

variable {H : Type*} [NormedAddCommGroup H] [InnerProductSpace ℂ H] [CompleteSpace H]
variable (H_minor : Submodule ℂ H) [CompleteSpace H_minor]

lemma inner_eq_inner_proj (f : H) (hf : f ∈ H_minor) (mu : H) :
  inner ℂ f mu = inner ℂ f (P_minor H_minor mu) := by
  rw [ ← sub_eq_zero ];
  simp [P_minor];
  -- Since $f \in H_{\text{minor}}$, and the projection is onto $H_{\text{minor}}$, the difference $f - (H_{\text{minor}}.starProjection) f$ is orthogonal to $H_{\text{minor}}$.
  have h_ortho : ⟪f, mu⟫_ℂ - ⟪f, (H_minor.starProjection) mu⟫_ℂ = ⟪f, mu - (H_minor.starProjection) mu⟫_ℂ := by
    rw [ inner_sub_right ];
  rw [ h_ortho, inner_eq_zero_symm ];
  exact?

end InnerProj

/-
Helper lemma: The norm of the inner product is bounded by the product of the norms of the vector and the projection of the other vector.
-/
section InnerProjBound

variable {H : Type*} [NormedAddCommGroup H] [InnerProductSpace ℂ H] [CompleteSpace H]
variable (H_minor : Submodule ℂ H) [CompleteSpace H_minor]

lemma inner_le_norm_mul_norm_proj (f : H) (hf : f ∈ H_minor) (mu : H) :
  ‖inner ℂ f mu‖ ≤ ‖f‖ * ‖P_minor H_minor mu‖ := by
  rw [ show ⟪f, mu⟫_ℂ = ⟪f, ( P_minor H_minor ) mu⟫_ℂ from ?_ ];
  · exact norm_inner_le_norm _ _;
  · exact?

end InnerProjBound

/-
Helper lemma: Bound on the inner product of a minor arc function with the model density.
-/
section CorollaryHelper

variable {H : Type*} [NormedAddCommGroup H] [InnerProductSpace ℂ H] [CompleteSpace H]
variable (mu_A : H) (H_minor : Submodule ℂ H) [CompleteSpace H_minor]
variable (delta_A : ℝ) (c : ℝ) (hc : 0 < c)

lemma inner_minor_bound (f : H) (hf : f ∈ H_minor) (hnorm : ‖f‖ ≤ 1)
    (h_MB : ‖P_minor H_minor mu_A‖ ≤ c * delta_A) :
  ‖inner ℂ f mu_A‖ ≤ c * delta_A := by
  apply le_trans (inner_le_norm_mul_norm_proj H_minor f hf mu_A);
  exact le_trans ( mul_le_of_le_one_left ( norm_nonneg _ ) hnorm ) h_MB

end CorollaryHelper