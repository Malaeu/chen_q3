% Two-Particle RKHS and Commutator Gram Structure
% Extension of ยง11 to twin-sector analysis

\section{Two-Particle RKHS Framework}\label{sec:rkhs-two-particle}

We extend the RKHS machinery of \S\ref{sec:rkhs} to the two-particle setting needed for twin prime analysis.

\subsection{Product RKHS}

\begin{definition}[Two-particle RKHS]\label{def:two-particle-rkhs}
Let $\mathcal{H}_t$ be the heat RKHS with kernel $k_t(x,y) = e^{-(x-y)^2/(4t)}$. The \emph{two-particle RKHS} is the tensor product
\[
  \mathcal{H}_t^{(2)} := \mathcal{H}_t \otimes \mathcal{H}_t
\]
with reproducing kernel
\[
  K_t^{(2)}((x_1,x_2),(y_1,y_2)) := k_t(x_1,y_1) \cdot k_t(x_2,y_2).
\]
\end{definition}

\begin{remark}
This is the standard Aronszajn product construction: the RKHS of a product space carries the product kernel.
\end{remark}

\subsection{Two-Particle Prime Operator}

\begin{definition}[Two-particle prime operator]\label{def:two-particle-prime}
On $\mathcal{H}_t^{(2)}$, define
\[
  T_P^{(2)} := \sum_{m,n \le X} w(m) w(n)\, |k_{\xi_m} \otimes k_{\xi_n}\rangle\langle k_{\xi_m} \otimes k_{\xi_n}|,
\]
where $w(n) = \Lambda(n)/\sqrt{n}$ and $\xi_n = \log n / (2\pi)$.
\end{definition}

\begin{lemma}[Gram structure]\label{lem:gram-two-particle}
Let $G$ be the one-particle Gram matrix with $G_{mn} = k_t(\xi_m, \xi_n)$. Then:
\begin{enumerate}[label=(\alph*)]
  \item The two-particle Gram matrix satisfies $G^{(2)} = G \otimes G$ (Kronecker product).
  \item Eigenvalues: $\lambda_{\min}(G^{(2)}) = \lambda_{\min}(G)^2$, $\lambda_{\max}(G^{(2)}) = \lambda_{\max}(G)^2$.
  \item $T_P^{(2)} = W^{(2)1/2} G^{(2)} W^{(2)1/2}$ where $W^{(2)} = \mathrm{diag}(w(m)w(n))$.
\end{enumerate}
\end{lemma}

\begin{proof}
Direct from the product kernel structure and properties of tensor products.
\end{proof}

\begin{proposition}[Two-particle RKHS bound]\label{prop:two-particle-bound}
Analogous to Proposition~\ref{prop:rkhs-prime-bound}, we have
\[
  \|T_P^{(2)}\| \le w_{\max}^2 + w_{\max} \cdot S_K^{(2)}(t),
\]
where $S_K^{(2)}(t)$ is the tail sum of exponential overlaps on the grid $\{\xi_m\} \times \{\xi_n\}$.
\end{proposition}

\subsection{Commutator Gram Representation}

Let $H_{\mathrm{twins}} := \mathrm{span}\{k_{\xi_p} : p \le X,\, p+2 \text{ prime}\}$ be the twin subspace.

\begin{definition}[Gram matrices for commutator]\label{def:comm-gram}
On twin indices $\{p : p \le X, p+2 \text{ prime}\}$, define:
\begin{align}
  K_{pq} &:= \langle k_{\xi_p}, k_{\xi_q} \rangle = k_t(\xi_p, \xi_q), \label{eq:gram-K}\\
  L_{pq} &:= \langle \Xi k_{\xi_p}, \Xi k_{\xi_q} \rangle, \label{eq:gram-L}\\
  M_{pq} &:= \langle \Xi k_{\xi_p}, k_{\xi_q} \rangle = \langle \partial_\xi k_{\xi_p}, k_{\xi_q} \rangle_{\text{weighted}}. \label{eq:gram-M}
\end{align}
Here $\Xi$ is the position operator (multiplication by $\xi$).
\end{definition}

\begin{lemma}[Gaussian overlap formulas]\label{lem:gaussian-overlaps}
Define $\partial k_r(\xi) := (\xi - \xi_r) k_t(\xi - \xi_r)$ (``derivative kernel'') and let $\delta_{rs} := \xi_s - \xi_r$, $G(\delta) := \sqrt{2\pi t}\, e^{-\delta^2/(8t)}$. Then:
\begin{align}
  \langle k_r, k_s \rangle &= G(\delta_{rs}), \label{eq:G1}\\
  \langle \partial k_r, k_s \rangle &= -\frac{\delta_{rs}}{2}\, G(\delta_{rs}), \label{eq:G2}\\
  \langle k_r, \partial k_s \rangle &= +\frac{\delta_{rs}}{2}\, G(\delta_{rs}), \label{eq:G3}\\
  \langle \partial k_r, \partial k_s \rangle &= \Bigl(t - \frac{\delta_{rs}^2}{4}\Bigr) G(\delta_{rs}). \label{eq:G4}
\end{align}
\end{lemma}

\begin{proof}
Standard Gaussian integrals. For \eqref{eq:G4}: substituting $u = \xi - (\xi_r + \xi_s)/2$ and $d = (\xi_s - \xi_r)/2$ gives
\[
  \langle \partial k_r, \partial k_s \rangle = e^{-d^2/(2t)} \int_{-\infty}^\infty (u^2 - d^2) e^{-u^2/(2t)}\, du = \sqrt{2\pi t}\, e^{-d^2/(2t)} (t - d^2).
\]
All formulas verified numerically with $<0.001\%$ error.
\end{proof}

\begin{theorem}[Explicit commutator kernel]\label{thm:K-comm}
Let $T_P = \sum_{r \le X} w_r |k_r\rangle\langle k_r|$ with $w_r = \Lambda(r)/\sqrt{r}$. Since $[T_A, \Xi] = 0$ (diagonal), we have $[H_X, \Xi] = -[T_P, \Xi]$. For the commutator
\[
  [T_P, \Xi] = \sum_r w_r \bigl(|k_r\rangle\langle \partial k_r| - |\partial k_r\rangle\langle k_r|\bigr),
\]
applied to the twin vector $\Phi_X = \sum_{p \in \mathcal{T}} \lambda_p k_{\xi_p}$ with $\lambda_p = \Lambda(p)\Lambda(p+2)$:
\[
  \|[T_P, \Xi]\Phi_X\|^2 = \sum_{p,q \in \mathcal{T}} \lambda_p \lambda_q \cdot K_{\mathrm{comm}}(\xi_p, \xi_q),
\]
where the \emph{commutator kernel} is
\begin{equation}\label{eq:K-comm}
  K_{\mathrm{comm}}(\xi_p, \xi_q) := \sum_{r,s \le X} w_r w_s\, G(\delta_{rp})\, G(\delta_{sq})\, G(\delta_{rs}) \cdot \Bigl[\frac{(\xi_p - \xi_s)(\xi_q - \xi_r)}{4} + t\Bigr],
\end{equation}
with $\delta_{xy} = \xi_y - \xi_x$ and $G(\delta) = \sqrt{2\pi t}\, e^{-\delta^2/(8t)}$.
\end{theorem}

\begin{proof}
Expand $[T_P, \Xi]\Phi_X = \sum_r w_r [A_r |k_r\rangle - B_r |\partial k_r\rangle]$ where $A_r = \langle \partial k_r, \Phi_X\rangle$ and $B_r = \langle k_r, \Phi_X\rangle$. Then
\[
  \|[T_P, \Xi]\Phi_X\|^2 = \sum_{r,s} w_r w_s \bigl[A_r A_s \langle k_r, k_s\rangle - A_r B_s \langle k_r, \partial k_s\rangle - B_r A_s \langle \partial k_r, k_s\rangle + B_r B_s \langle \partial k_r, \partial k_s\rangle\bigr].
\]
Substituting from Lemma~\ref{lem:gaussian-overlaps} and collecting terms in $\lambda_p \lambda_q$ yields the bracket
\[
  \frac{\delta_{rp}\delta_{sq}}{4} + \frac{\delta_{rp}\delta_{rs}}{4} - \frac{\delta_{sq}\delta_{rs}}{4} + t - \frac{\delta_{rs}^2}{4} = \frac{(\xi_p - \xi_s)(\xi_q - \xi_r)}{4} + t,
\]
where the simplification uses $\delta_{rp} - \delta_{rs} = \xi_p - \xi_s$ and $\delta_{sq} + \delta_{rs} = \xi_q - \xi_r$.
\end{proof}

\begin{remark}[Structure of $K_{\mathrm{comm}}$]
The kernel \eqref{eq:K-comm} has the form ``position difference squared plus constant'' weighted by triple-Gaussian decay. For twin pairs with $\xi_{p+2} - \xi_p \sim 1/(\pi p) \to 0$, the bracket $\approx t$ and the triple-Gaussian localises contributions to nearby primes $r \approx p$, $s \approx q$.
\end{remark}

\begin{proposition}[Commutator as Gram quadratic form]\label{prop:comm-gram}
Let $C_X := [H_X, \Xi]$ be the commutator. On the twin subspace, for any $f = \sum_p a_p k_{\xi_p}$:
\begin{enumerate}[label=(\alph*)]
  \item The matrix $Q_X$ with entries $Q_{pq} = K_{\mathrm{comm}}(\xi_p, \xi_q)$ satisfies
  \[
    \|C_X f\|^2 = a^\top Q_X a.
  \]
  \item $Q_X$ is symmetric positive semidefinite (as a Gram matrix of commutator images).
  \item The Rayleigh quotient satisfies
  \[
    R_X(f) := \frac{\|C_X f\|^2}{\|f\|^2} = \frac{a^\top Q_X a}{a^\top K_{\mathrm{twins}} a}.
  \]
\end{enumerate}
\end{proposition}

\begin{proof}
Part (a) follows from Theorem~\ref{thm:K-comm}. Part (b): $Q_X$ is a Gram matrix since $Q_{pq} = \langle C_X k_{\xi_p}, C_X k_{\xi_q}\rangle$ restricted to twin indices. Part (c) is the definition of Rayleigh quotient with numerator from (a) and denominator from the standard heat kernel Gram matrix.
\end{proof}

\subsection{The Key Analytic Hypothesis}

\begin{hypothesis}[Twin-RKHS lower bound --- explicit form]\label{hyp:twin-rkhs}
\textbf{(H\textsubscript{twin-RKHS})} There exist constants $\alpha \in (0,2)$ and $c_0 > 0$ such that for all sufficiently large $X$:
\begin{equation}\label{eq:H-twin-explicit}
  \sum_{\substack{p,q \le X \\ p+2, q+2 \text{ prime}}} \lambda_p \lambda_q \cdot K_{\mathrm{comm}}(\xi_p, \xi_q) \;\ge\; c_0\, T(X)^\alpha,
\end{equation}
where:
\begin{itemize}
  \item $\lambda_p = \Lambda(p)\Lambda(p+2) = \log(p)\log(p+2)$ (twin weight);
  \item $\xi_p = \log p / (2\pi)$ (spectral coordinate);
  \item $K_{\mathrm{comm}}$ is the explicit kernel from \eqref{eq:K-comm};
  \item $T(X) = \sum_{n \le X} \Lambda(n)\Lambda(n+2)$ is the twin sum.
\end{itemize}
Equivalently, writing $\Phi_X = \sum_{p \in \mathcal{T}} \lambda_p k_{\xi_p}$:
\[
  \|[H_X, \Xi] \Phi_X\|^2 \ge c_0\, T(X)^\alpha.
\]
\end{hypothesis}

\begin{remark}[Fully expanded double sum]
Expanding \eqref{eq:H-twin-explicit} using \eqref{eq:K-comm}:
\begin{multline}\label{eq:full-expansion}
  \sum_{\substack{p,q \in \mathcal{T}}} \lambda_p \lambda_q \sum_{r,s \le X} w_r w_s\, G(\xi_p - \xi_r)\, G(\xi_q - \xi_s)\, G(\xi_s - \xi_r) \cdot \Bigl[\frac{(\xi_p - \xi_s)(\xi_q - \xi_r)}{4} + t\Bigr] \\
  \ge\; c_0\, T(X)^\alpha.
\end{multline}
This is a \textbf{4-index sum} over twin pairs $(p,q)$ and all primes $(r,s)$, with weights $\lambda_p, \lambda_q, w_r, w_s$ and triple-Gaussian decay controlling long-range contributions.
\end{remark}

\begin{remark}[Status of Hypothesis~\ref{hyp:twin-rkhs}]
\textbf{What is analytically provable:}
\begin{enumerate}
  \item Lemma~\ref{lem:gaussian-overlaps}: All four overlap formulas are exact Gaussian integrals --- \emph{rigorous}.
  \item Theorem~\ref{thm:K-comm}: The explicit kernel formula \eqref{eq:K-comm} --- \emph{rigorous derivation}.
  \item Proposition~\ref{prop:comm-gram}: $Q_X$ is positive semidefinite --- \emph{rigorous} (Gram matrix property).
\end{enumerate}

\textbf{What is hard (requires number theory):}
\begin{enumerate}
  \item Lower bound for the 4-index sum \eqref{eq:full-expansion} in terms of $T(X)^\alpha$;
  \item This requires twin-pair correlation estimates under HL(2), showing the double sum $\sum_{p,q} \lambda_p \lambda_q K_{\mathrm{comm}}(\xi_p, \xi_q)$ is not too small.
\end{enumerate}

\textbf{Numerical evidence:} Log-log regression on $X \in [500, 20000]$ gives $\alpha \approx 1.64$ with coefficient of variation $\approx 10\%$ for the resonance product $R(X) \approx 108$ (stable).
\end{remark}

\subsection{Conditional Main Results}

\begin{lemma}[Conditional commutator scaling]\label{lem:comm-conditional}
Assume RH+Q3, HL(2), and Hypothesis~\ref{hyp:twin-rkhs}. Then:
\begin{enumerate}[label=(\alph*)]
  \item $\|\Phi_X\|^2 \asymp c_1 T(X)^2$ (follows from HL(2) and Gram structure).
  \item $\|[H_X, \Xi] \Phi_X\|^2 \ge c_0 T(X)^\alpha$ (by hypothesis).
  \item The normalised defect satisfies
  \[
    D^2(X) := \|[H_X, S_{\delta_X}] \Psi_X\|^2 \asymp \frac{C}{T(X)^\beta} \cdot (\log T)^{O(1)},
  \]
  where $\beta = 2 - \alpha > 0$ and $\delta_X = 1/X$.
\end{enumerate}
\end{lemma}

\begin{proof}
Part (a): The norm $\|\Phi_X\|^2 = a^\top K_{\mathrm{twins}} a$ is a double sum over twin pairs with heat kernel weights. Under HL(2), this is asymptotic to $c_1 T(X)^2$ (diagonal dominates, off-diagonal controlled by exponential decay).

Part (b): By hypothesis.

Part (c): From Lemma~\ref{lem:score}(b), $D^2(X) = \delta_X^2 \|[H_X, \Xi] \Psi_X\|^2 + O(\delta_X^4)$. With $\delta_X = 1/X$ and $X \sim T(X) (\log X)^2$ (HL), we get $D^2(X) \asymp C/T(X)^\beta$.
\end{proof}

\begin{theorem}[Conditional commutator criterion]\label{thm:comm-criterion-conditional}
Assume RH+Q3, HL(2), and Hypothesis~\ref{hyp:twin-rkhs}. Define
\[
  R(X) := D^2(X) \cdot T(X)^\beta, \quad \beta = 2 - \alpha.
\]
Then:
\begin{enumerate}[label=(\roman*)]
  \item (HL $\Rightarrow$ stable $R$) Under Hardy--Littlewood: $\liminf_{X \to \infty} R(X) > 0$.
  \item (Finite twins $\Rightarrow$ decay) If only finitely many twin primes exist: $R(X) \to 0$.
  \item (Equivalence) Infinitely many twin primes $\Longleftrightarrow$ $\liminf_{X \to \infty} R(X) > 0$.
\end{enumerate}
\end{theorem}

\begin{proof}
(i) Follows from Lemma~\ref{lem:comm-conditional}(c): $R(X) = D^2 \cdot T^\beta \asymp C > 0$.

(ii) With frozen twins, $\Phi_X = \Phi_0$ is fixed but $\delta_X = 1/X \to 0$. The growth of $\|[H_X, \Xi] \Phi_0\|$ is subquadratic in $X$ (heat kernel localisation), yielding $D^2(X) \lesssim C/X^{2\gamma}$ with $\gamma > 0$. Hence $R(X) = D^2 \cdot T_0^\beta \to 0$.

(iii) Combination of (i) and (ii) by contraposition.
\end{proof}

\subsection{Open Problem}

\begin{openproblem}[Twin-pair correlation lower bound]\label{prob:twin-correlation}
Prove Hypothesis~\ref{hyp:twin-rkhs} under HL(2). Equivalently, show that the Gram quadratic form
\[
  \sum_{p,q \text{ twin}} a_p a_q Q_{pq} \ge c_0 T(X)^\alpha
\]
where $a_p = \Lambda(p)\Lambda(p+2)$ and $Q_{pq}$ encodes the commutator structure from Definition~\ref{def:comm-gram}.

\medskip\noindent
\textbf{Numerical evidence:} Log-log regression on $X \in [500, 20000]$ gives $\alpha \approx 0.36$ with coefficient of variation $\approx 10\%$ for the stable $R(X)$.
\end{openproblem}
